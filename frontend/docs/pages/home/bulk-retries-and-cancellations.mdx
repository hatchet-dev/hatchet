import { Callout, Card, Cards, Steps, Tabs } from "nextra/components";
import UniversalTabs from "@/components/UniversalTabs";
import { GithubSnippet, getSnippets } from "@/components/code";

export const CancelPy = {
  path: "examples/bulk_operations/cancel.py",
};
export const ReplayPy = {
  path: "examples/bulk_operations/replay.py",
};

export const getStaticProps = ({}) => getSnippets([CancelPy, ReplayPy]);

## Bulk Cancellations and Replays

V1 add the ability to cancel or replay workflow runs in bulk, which you can now do either in the Hatchet Dashboard or programmatically via the SDKs and the REST API.

There are two ways of bulk cancelling or replaying workflows in both cases:

1. You can provide a list of workflow run ids to cancel or replay, which will cancel or replay all of the workflows in the list.
2. You can provide a list of filters, similar to the list of filters on workflow runs in the Dashboard, and cancel or replay runs matching those filters. For instance, if you wanted to replay all failed runs of a `SimpleWorkflow` from the past fifteen minutes that had the `foo` field in `additional_metadata` set to `bar`, you could apply those filters and replay all of the matching runs.

### Bulk Operations by Run Ids

The first way to bulk cancel or replay runs is by providing a list of run ids. This is the most straightforward way to cancel or replay runs in bulk.

<UniversalTabs items={["Python"]}>
{/* <UniversalTabs items={["Python", "Typescript", "Go"]}> TODO V1 DOCS - Add TS and Go */}
  <Tabs.Tab title="Python">

<Callout type="info">
  In the Python SDK, the mechanics of bulk replaying and bulk cancelling
  workflows are exactly the same. The only change would be replacing e.g.
  `hatchet.runs.bulk_cancel` with `hatchet.runs.bulk_replay`.
</Callout>

    First, we'll start by fetching a workflow via the REST API.

    <GithubSnippet src={CancelPy} target="Setup" />

    Now that we have a workflow, we'll get runs for it, so that we can use them to bulk cancel by run id.

    <GithubSnippet src={CancelPy} target="List runs" />

    And finally, we can cancel the runs in bulk.

    <GithubSnippet src={CancelPy} target="Cancel by run ids" />

    <Callout type="info">
      Note that the Python SDK also exposes async versions of each of these methods:

      - `workflows.list` -> `await workflows.aio_list`
      - `runs.list` -> `await runs.aio_list`
      - `runs.bulk_cancel` -> `await runs.aio_bulk_cancel`
      </Callout>

  </Tabs.Tab>
  {/* <Tabs.Tab title="Typescript">
    TODO V1 DOCS
  </Tabs.Tab>
  <Tabs.Tab title="Go">
    TODO V1 DOCS
  </Tabs.Tab> */}
</UniversalTabs>

### Bulk Operations by Filters

The second way to bulk cancel or replay runs is by providing a list of filters. This is the most powerful way to cancel or replay runs in bulk, as it allows you to cancel or replay all runs matching a set of arbitrary filters without needing to provide IDs for the runs in advance.

<UniversalTabs items={["Python"]}>
{/* <UniversalTabs items={["Python", "Typescript", "Go"]}> TODO V1 DOCS - Add TS and Go */}
  <Tabs.Tab title="Python">

    The example below provides some filters you might use to cancel or replay runs in bulk. Importantly, these filters are very similar to the filters you can use in the Hatchet Dashboard to filter which workflow runs are displaying.

    <GithubSnippet src={CancelPy} target="Cancel by filters" />

    Running this request will cancel all workflow runs matching the filters provided.

  </Tabs.Tab>
  {/* <Tabs.Tab title="Typescript">
    TODO V1 DOCS
  </Tabs.Tab>
  <Tabs.Tab title="Go">
    TODO V1 DOCS
  </Tabs.Tab> */}
</UniversalTabs>
