syntax = "proto3";

option go_package = "github.com/hatchet-dev/hatchet/internal/services/shared/proto/v1";

package v1;

enum Action {
    CREATE = 0;
    QUEUE = 1;
    CANCEL = 2;
    SKIP = 3;
}

message BaseMatchCondition {
    string readableDataKey = 1;
    Action action = 2;
    string orGroupId = 3; // a UUID defining the OR group for this condition
    string expression = 4;
}

message ParentOverrideMatchCondition {
    BaseMatchCondition base = 1;
    string parentReadableId = 2;
}

message SleepMatchCondition {
    BaseMatchCondition base = 1;
    string sleepFor = 2; // a duration string indicating how long to sleep
}

message UserEventMatchCondition {
    BaseMatchCondition base = 1;
    string userEventKey = 2;
}

message TaskConditions {
    repeated ParentOverrideMatchCondition parentOverrideConditions = 1;
    repeated SleepMatchCondition sleepConditions = 2;
    repeated UserEventMatchCondition userEventConditions = 3;
}

message DurableEventListenerConditions {
    repeated SleepMatchCondition sleepConditions = 1;
    repeated UserEventMatchCondition userEventConditions = 2;
}
